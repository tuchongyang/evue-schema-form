(function(e,o){"object"===typeof exports&&"object"===typeof module?module.exports=o(require("vue")):"function"===typeof define&&define.amd?define([],o):"object"===typeof exports?exports["evue-schema-form"]=o(require("vue")):e["evue-schema-form"]=o(e["Vue"])})("undefined"!==typeof self?self:this,(function(e){return function(){"use strict";var o={769:function(e,o){o.Z=(e,o)=>{const t=e.__vccOpts||e;for(const[l,n]of o)t[l]=n;return t}},203:function(o){o.exports=e}},t={};function l(e){var n=t[e];if(void 0!==n)return n.exports;var a=t[e]={exports:{}};return o[e](a,a.exports,l),a.exports}!function(){l.d=function(e,o){for(var t in o)l.o(o,t)&&!l.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:o[t]})}}(),function(){l.o=function(e,o){return Object.prototype.hasOwnProperty.call(e,o)}}(),function(){l.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){l.p=""}();var n={};return function(){if(l.r(n),l.d(n,{FormDialog:function(){return Pe},SchemaForm:function(){return Ie}}),"undefined"!==typeof window){var e=window.document.currentScript,o=e&&e.src.match(/(.+\/)[^/]+\.js(\?.*)?$/);o&&(l.p=o[1])}var t=l(203);function a(e,o,l,n,a,r){const m=(0,t.resolveComponent)("el-form-item"),d=(0,t.resolveComponent)("el-form");return(0,t.openBlock)(),(0,t.createBlock)(d,(0,t.mergeProps)({ref:"schemaFormRef",model:e.modelRef,rules:e.rulesRef},e.$attrs,{class:"schema-form",style:{display:"flex","flex-wrap":"wrap",position:"relative","box-sizing":"border-box"},"label-width":e.formSchema.labelWidth||"110px"}),{default:(0,t.withCtx)((()=>[((0,t.openBlock)(!0),(0,t.createElementBlock)(t.Fragment,null,(0,t.renderList)(e.schemaItems,(o=>((0,t.openBlock)(),(0,t.createBlock)(m,{key:o.prop,label:o.label,prop:o.prop,"label-width":o.labelWidth,style:(0,t.normalizeStyle)({maxWidth:100*o.span/24+"%",flex:"0 0 "+100*o.span/24+"%"})},{default:(0,t.withCtx)((()=>[((0,t.openBlock)(),(0,t.createBlock)((0,t.resolveDynamicComponent)(e.getComponent(o.type)),{modelValue:e.modelRef[o.prop],"onUpdate:modelValue":t=>e.modelRef[o.prop]=t,"form-item":o},null,8,["modelValue","onUpdate:modelValue","form-item"]))])),_:2},1032,["label","prop","label-width","style"])))),128)),e.$slots["operate-button"]?((0,t.openBlock)(),(0,t.createBlock)(m,{key:0,style:{"max-width":"100%",flex:"0 0 100%"}},{default:(0,t.withCtx)((()=>[(0,t.renderSlot)(e.$slots,"operate-button",{},void 0,!0)])),_:3})):(0,t.createCommentVNode)("",!0)])),_:3},16,["model","rules","label-width"])}const r=Object.prototype.toString;function m(e,o){return r.call(e)===`[object ${o}]`}function d(e){return m(e,"Function")}function c(e){return m(e,"AsyncFunction")}const s={key:0,class:"loading",style:{color:"#999","font-size":"12px"}},p=(0,t.createTextVNode)(" 加载中... ");function u(e,o,l,n,a,r){const m=(0,t.resolveComponent)("Loading"),d=(0,t.resolveComponent)("el-icon"),c=(0,t.resolveComponent)("el-checkbox"),u=(0,t.resolveComponent)("el-checkbox-group");return e.formItem.loading?((0,t.openBlock)(),(0,t.createElementBlock)("div",s,[(0,t.createVNode)(d,{class:"is-loading"},{default:(0,t.withCtx)((()=>[(0,t.createVNode)(m)])),_:1}),p])):((0,t.openBlock)(),(0,t.createBlock)(u,(0,t.mergeProps)({key:1,modelValue:e.model,"onUpdate:modelValue":o[0]||(o[0]=o=>e.model=o),style:{width:"100%"}},(0,t.toHandlers)(e.formItem.eventObject)),{default:(0,t.withCtx)((()=>[((0,t.openBlock)(!0),(0,t.createElementBlock)(t.Fragment,null,(0,t.renderList)(e.formItem.options,(e=>((0,t.openBlock)(),(0,t.createBlock)(c,{key:e.value,label:e.value},{default:(0,t.withCtx)((()=>[(0,t.createTextVNode)((0,t.toDisplayString)(e.label),1)])),_:2},1032,["label"])))),128))])),_:1},16,["modelValue"]))}var i=(e,o)=>{const t=e.__vccOpts||e;for(const[l,n]of o)t[l]=n;return t};const f=(0,t.defineComponent)({name:"Loading"}),v={class:"icon",width:"200",height:"200",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"},h=(0,t.createElementVNode)("path",{fill:"currentColor",d:"M512 64a32 32 0 0132 32v192a32 32 0 01-64 0V96a32 32 0 0132-32zm0 640a32 32 0 0132 32v192a32 32 0 11-64 0V736a32 32 0 0132-32zm448-192a32 32 0 01-32 32H736a32 32 0 110-64h192a32 32 0 0132 32zm-640 0a32 32 0 01-32 32H96a32 32 0 010-64h192a32 32 0 0132 32zM195.2 195.2a32 32 0 0145.248 0L376.32 331.008a32 32 0 01-45.248 45.248L195.2 240.448a32 32 0 010-45.248zm452.544 452.544a32 32 0 0145.248 0L828.8 783.552a32 32 0 01-45.248 45.248L647.744 692.992a32 32 0 010-45.248zM828.8 195.264a32 32 0 010 45.184L692.992 376.32a32 32 0 01-45.248-45.248l135.808-135.808a32 32 0 0145.248 0zm-452.544 452.48a32 32 0 010 45.248L240.448 828.8a32 32 0 01-45.248-45.248l135.808-135.808a32 32 0 0145.248 0z"},null,-1),V=[h];function b(e,o,l,n,a,r){return(0,t.openBlock)(),(0,t.createElementBlock)("svg",v,V)}var g=i(f,[["render",b]]),y=(0,t.defineComponent)({name:"SchemaFormCheckbox",components:{Loading:g},props:{formItem:{type:Object,default:()=>({})},modelValue:void 0},emits:["update:modelValue"],setup(e,{emit:o}){const l=(0,t.computed)({get:()=>e.modelValue,set:e=>o("update:modelValue",e)});return l.value instanceof Array||(l.value=[]),{model:l}}}),k=l(769);const C=(0,k.Z)(y,[["render",u]]);var I=C;function w(e,o,l,n,a,r){const m=(0,t.resolveComponent)("el-input-number");return(0,t.openBlock)(),(0,t.createBlock)(m,(0,t.mergeProps)({modelValue:e.model,"onUpdate:modelValue":o[0]||(o[0]=o=>e.model=o)},e.formItem.props,(0,t.toHandlers)(e.formItem.eventObject),{style:{width:"100%"}}),null,16,["modelValue"])}var B=(0,t.defineComponent)({name:"SchemaFormInputNumber",components:{},props:{formItem:{type:Object,default:()=>({})},modelValue:void 0},emits:["update:modelValue"],setup(e,{emit:o}){const l=(0,t.computed)({get:()=>e.modelValue,set:e=>o("update:modelValue",e)});return{model:l}}});const x=(0,k.Z)(B,[["render",w]]);var S=x;function O(e,o,l,n,a,r){const m=(0,t.resolveComponent)("el-input");return(0,t.openBlock)(),(0,t.createBlock)(m,(0,t.mergeProps)({modelValue:e.model,"onUpdate:modelValue":o[0]||(o[0]=o=>e.model=o),disabled:e.formItem.disabled||!1},e.formItem.props,{placeholder:e.formItem.props&&e.formItem.props.placeholder||"请输入"+e.formItem.label,autocomplete:"new-password"},(0,t.toHandlers)(e.formItem.eventObject)),null,16,["modelValue","disabled","placeholder"])}var F=(0,t.defineComponent)({name:"SchemaFormInput",components:{},props:{formItem:{type:Object,default:()=>({})},modelValue:void 0},emits:["update:modelValue"],setup(e,{emit:o}){const l=(0,t.computed)({get:()=>e.modelValue,set:e=>o("update:modelValue",e)});return{model:l}}});const j=(0,k.Z)(F,[["render",O]]);var L=j;const _={key:0,class:"loading",style:{color:"#999","font-size":"12px"}},N=(0,t.createTextVNode)(" 加载中... ");function P(e,o,l,n,a,r){const m=(0,t.resolveComponent)("Loading"),d=(0,t.resolveComponent)("el-icon"),c=(0,t.resolveComponent)("el-radio"),s=(0,t.resolveComponent)("el-radio-group");return e.formItem.loading?((0,t.openBlock)(),(0,t.createElementBlock)("div",_,[(0,t.createVNode)(d,{class:"is-loading"},{default:(0,t.withCtx)((()=>[(0,t.createVNode)(m)])),_:1}),N])):((0,t.openBlock)(),(0,t.createBlock)(s,(0,t.mergeProps)({key:1,modelValue:e.model,"onUpdate:modelValue":o[0]||(o[0]=o=>e.model=o)},(0,t.toHandlers)(e.formItem.eventObject)),{default:(0,t.withCtx)((()=>[((0,t.openBlock)(!0),(0,t.createElementBlock)(t.Fragment,null,(0,t.renderList)(e.formItem.options,(e=>((0,t.openBlock)(),(0,t.createBlock)(c,{key:e.value,label:e.value},{default:(0,t.withCtx)((()=>[(0,t.createTextVNode)((0,t.toDisplayString)(e.label),1)])),_:2},1032,["label"])))),128))])),_:1},16,["modelValue"]))}var U=(0,t.defineComponent)({name:"SchemaFormRadio",components:{Loading:g},props:{formItem:{type:Object,default:()=>({})},modelValue:void 0},emits:["update:modelValue"],setup(e,{emit:o}){const l=(0,t.computed)({get:()=>e.modelValue,set:e=>o("update:modelValue",e)});return{model:l}}});const z=(0,k.Z)(U,[["render",P]]);var E=z;function H(e,o,l,n,a,r){const m=(0,t.resolveComponent)("el-option"),d=(0,t.resolveComponent)("el-select");return(0,t.openBlock)(),(0,t.createBlock)(d,(0,t.mergeProps)({modelValue:e.model,"onUpdate:modelValue":o[0]||(o[0]=o=>e.model=o),mode:e.formItem.mode||""},e.formItem.props,(0,t.toHandlers)(e.formItem.eventObject),{style:{width:"100%"},loading:e.formItem.loading}),{default:(0,t.withCtx)((()=>[((0,t.openBlock)(!0),(0,t.createElementBlock)(t.Fragment,null,(0,t.renderList)(e.formItem.options,(e=>((0,t.openBlock)(),(0,t.createBlock)(m,{key:e.value,value:e.value,label:e.label},null,8,["value","label"])))),128))])),_:1},16,["modelValue","mode","loading"])}var R=(0,t.defineComponent)({name:"SchemaFormSelect",components:{},props:{formItem:{type:Object,default:()=>({})},modelValue:void 0},emits:["update:modelValue"],setup(e,{emit:o}){const l=(0,t.computed)({get:()=>e.modelValue,set:e=>o("update:modelValue",e)});return{model:l}}});const T=(0,k.Z)(R,[["render",H]]);var Z=T;function M(e,o,l,n,a,r){const m=(0,t.resolveComponent)("el-switch");return(0,t.openBlock)(),(0,t.createBlock)(m,(0,t.mergeProps)({modelValue:e.model,"onUpdate:modelValue":o[0]||(o[0]=o=>e.model=o)},e.formItem.props,(0,t.toHandlers)(e.formItem.eventObject)),null,16,["modelValue"])}var D=(0,t.defineComponent)({name:"SchemaFormTextarea",components:{},props:{formItem:{type:Object,default:()=>({})},modelValue:void 0},emits:["update:modelValue"],setup(e,{emit:o}){const l=(0,t.computed)({get:()=>e.modelValue,set:e=>o("update:modelValue",e)});return{model:l}}});const Y=(0,k.Z)(D,[["render",M]]);var $=Y;const A=["src"];function q(e,o,l,n,a,r){const m=(0,t.resolveComponent)("Plus"),d=(0,t.resolveComponent)("el-icon"),c=(0,t.resolveComponent)("el-upload");return(0,t.openBlock)(),(0,t.createBlock)(c,{"file-list":e.fileList,"onUpdate:file-list":o[0]||(o[0]=o=>e.fileList=o),name:"avatar","list-type":"picture-card",class:"avatar-uploader","show-upload-list":!1,action:e.uploadUrl,"before-upload":e.beforeUpload,headers:e.headers,"on-success":e.handleAvatarSuccess,onChange:e.handleChange},{default:(0,t.withCtx)((()=>[e.imageUrl?((0,t.openBlock)(),(0,t.createElementBlock)("img",{key:0,src:e.imageUrl,class:"avatar"},null,8,A)):((0,t.openBlock)(),(0,t.createBlock)(d,{key:1,class:"avatar-uploader-icon"},{default:(0,t.withCtx)((()=>[(0,t.createVNode)(m)])),_:1}))])),_:1},8,["file-list","action","before-upload","headers","on-success","onChange"])}const W=(0,t.defineComponent)({name:"Plus"}),G={class:"icon",width:"200",height:"200",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"},J=(0,t.createElementVNode)("path",{fill:"currentColor",d:"M480 480V128a32 32 0 0164 0v352h352a32 32 0 110 64H544v352a32 32 0 11-64 0V544H128a32 32 0 010-64h352z"},null,-1),K=[J];function Q(e,o,l,n,a,r){return(0,t.openBlock)(),(0,t.createElementBlock)("svg",G,K)}var X=i(W,[["render",Q]]),ee=(0,t.defineComponent)({name:"SchemaFormFile",components:{Plus:X},props:{formItem:{type:Object,default:()=>({})},modelValue:void 0},emits:["update:modelValue"],setup(e,{emit:o}){const l=(0,t.computed)({get:()=>e.modelValue,set:e=>o("update:modelValue",e)}),n=(0,t.ref)([]),a=(0,t.ref)(!1),r=(0,t.ref)(""),m=e.formItem.action||"#",d={authorization:localStorage.getItem("token")},c=o=>{e.formItem.change&&e.formItem.change(o.raw)},s=(o,t)=>{e.formItem.success&&e.formItem.success(o,t)},p=o=>{const t=!e.formItem.fileType||o.type.indexOf(e.formItem.fileType)>-1,l=o.size-e.formItem.maxsize;return t&&l&&e.formItem.beforeUpload&&e.formItem.beforeUpload(t,l),t&&l};return{model:l,fileList:n,loading:a,imageUrl:r,uploadUrl:m,handleChange:c,beforeUpload:p,handleAvatarSuccess:s,headers:d}}});const oe=(0,k.Z)(ee,[["render",q],["__scopeId","data-v-2134677a"]]);var te=oe;function le(e,o,l,n,a,r){const m=(0,t.resolveComponent)("el-input");return(0,t.openBlock)(),(0,t.createBlock)(m,(0,t.mergeProps)({modelValue:e.model,"onUpdate:modelValue":o[0]||(o[0]=o=>e.model=o),type:"password"},e.formItem.props,{placeholder:e.formItem.props&&e.formItem.props.placeholder||"请输入"+e.formItem.label,autocomplete:"new-password"},(0,t.toHandlers)(e.formItem.eventObject)),null,16,["modelValue","placeholder"])}var ne=(0,t.defineComponent)({name:"SchemaFormInputPassword",components:{},props:{formItem:{type:Object,default:()=>({})},modelValue:void 0},emits:["update:modelValue"],setup(e,{emit:o}){const l=(0,t.computed)({get:()=>e.modelValue,set:e=>o("update:modelValue",e)});return{model:l}}});const ae=(0,k.Z)(ne,[["render",le]]);var re=ae;function me(e,o,l,n,a,r){const m=(0,t.resolveComponent)("el-date-picker");return(0,t.openBlock)(),(0,t.createBlock)(m,(0,t.mergeProps)({modelValue:e.model,"onUpdate:modelValue":o[0]||(o[0]=o=>e.model=o),type:"date",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD"},e.formItem.props,{disabled:e.formItem.disabled||!1,placeholder:e.formItem.props&&e.formItem.props.placeholder||"请选择"+e.formItem.label},(0,t.toHandlers)(e.formItem.eventObject),{style:{width:"100%"}}),null,16,["modelValue","disabled","placeholder"])}var de=(0,t.defineComponent)({name:"SchemaFormInput",components:{},props:{formItem:{type:Object,default:()=>({})},modelValue:void 0},emits:["update:modelValue"],setup(e,{emit:o}){const l=(0,t.computed)({get:()=>e.modelValue,set:e=>o("update:modelValue",e)});return{model:l}}});const ce=(0,k.Z)(de,[["render",me]]);var se=ce;function pe(e,o,l,n,a,r){const m=(0,t.resolveComponent)("el-color-picker");return(0,t.openBlock)(),(0,t.createBlock)(m,(0,t.mergeProps)({modelValue:e.model,"onUpdate:modelValue":o[0]||(o[0]=o=>e.model=o),"show-alpha":""},e.formItem.props,(0,t.toHandlers)(e.formItem.eventObject)),null,16,["modelValue"])}var ue=(0,t.defineComponent)({name:"SchemaFormInput",components:{},props:{formItem:{type:Object,default:()=>({})},modelValue:void 0},emits:["update:modelValue"],setup(e,{emit:o}){const l=(0,t.computed)({get:()=>e.modelValue,set:e=>o("update:modelValue",e)});return{model:l}}});const ie=(0,k.Z)(ue,[["render",pe]]);var fe=ie;const ve=["innerHTML"];function he(e,o,l,n,a,r){return(0,t.openBlock)(),(0,t.createElementBlock)("div",{innerHTML:e.model},null,8,ve)}var Ve=(0,t.defineComponent)({name:"SchemaFormInput",components:{},props:{formItem:{type:Object,default:()=>({})},modelValue:void 0},emits:["update:modelValue"],setup(e,{emit:o}){const l=(0,t.computed)({get:()=>e.modelValue,set:e=>o("update:modelValue",e)});return{model:l}}});const be=(0,k.Z)(Ve,[["render",he]]);var ge=be,ye={SchemaFormCheckbox:I,SchemaFormInputNumber:S,SchemaFormInput:L,SchemaFormRadio:E,SchemaFormSelect:Z,SchemaFormSwitch:$,SchemaFormFile:te,SchemaFormInputPassword:re,SchemaFormDatePicker:se,SchemaFormColorPicker:fe,SchemaFormValue:ge},ke=(0,t.defineComponent)({name:"SchemaForm",components:{...ye},props:{formSchema:{required:!0,type:Object},fields:{type:Object,default:()=>({})},modelValue:{type:Object,default:void 0}},emits:["update:modelValue"],setup(e,{emit:o}){const l=(0,t.ref)(),n=(0,t.getCurrentInstance)(),a=(0,t.reactive)(e.formSchema.formItem.reduce(((e,o)=>(o.eventObject??={},e[o.prop]=o.value||void 0,e)),{}));(0,t.watch)((()=>a),(e=>{o("update:modelValue",(0,t.toRefs)(e))}),{deep:!0}),(0,t.watch)((()=>e.modelValue),(e=>{Object.assign(a,e)}),{deep:!0}),e.fields&&Object.assign(a,e.fields),e.modelValue&&Object.assign(a,e.modelValue),e.formSchema.formItem.forEach((async e=>{d(e.asyncOptions)||c(e.asyncOptions)?(e.loading=!0,e.options=await e.asyncOptions(e,n).finally((()=>e.loading=!1))):(d(e.asyncValue)||c(e.asyncValue))&&(e.loading=!0,a[e.prop]=await e.asyncValue(e,n).finally((()=>e.loading=!1)))}));const r=(0,t.computed)((()=>e.formSchema.formItem.filter((e=>!e.hidden||(e.hidden instanceof Function?!e.hidden(a):e.hidden))))),m=(0,t.computed)((()=>e.formSchema.rules)),s=["input","select","radio","checkbox","input-number","input-range","switch","file","input-password","date-picker","color-picker","value"],p=e=>s.includes(e)?"schema-form-"+e:(0,t.isReactive)(e)||(0,t.isRef)(e)?(0,t.createVNode)(e):e,u=e=>l.value.validate(e),i=async o=>{const t=e.formSchema.formItem.find((e=>e.prop==o));return t.loading=!0,t.options=await t.asyncOptions(t,n).finally((()=>t.loading=!1)),t};return{modelRef:a,schemaFormRef:l,rulesRef:m,getComponent:p,schemaItems:r,validate:u,loadOptions:i}}});const Ce=(0,k.Z)(ke,[["render",a],["__scopeId","data-v-85f3be54"]]);var Ie=Ce;const we={class:"dialog-footer"},Be=(0,t.createTextVNode)("取消"),xe=(0,t.createTextVNode)("确 定");function Se(e,o,l,n,a,r){const m=(0,t.resolveComponent)("schema-form"),d=(0,t.resolveComponent)("el-button"),c=(0,t.resolveComponent)("el-dialog");return(0,t.openBlock)(),(0,t.createBlock)(c,(0,t.mergeProps)({modelValue:e.visible,"onUpdate:modelValue":o[0]||(o[0]=o=>e.visible=o)},e.$attrs,{title:e.title,width:"60%","before-close":e.remove}),{footer:(0,t.withCtx)((()=>[(0,t.createElementVNode)("span",we,[(0,t.createVNode)(d,{onClick:e.remove,disabled:e.confirmLoading},{default:(0,t.withCtx)((()=>[Be])),_:1},8,["onClick","disabled"]),(0,t.createVNode)(d,{type:"primary",onClick:e.onOk,disabled:e.confirmLoading},{default:(0,t.withCtx)((()=>[xe])),_:1},8,["onClick","disabled"])])])),default:(0,t.withCtx)((()=>[(0,t.createVNode)(m,{ref:"dynamicForm",fields:e.fields,"form-schema":e.dynamicValidateForm,style:{margin:"0 40px 0 20px"}},null,8,["fields","form-schema"])])),_:1},16,["modelValue","title","before-close"])}var Oe=(0,t.defineComponent)({name:"FormDialog",components:{SchemaForm:Ie},props:{title:{type:String,default:""},remove:{type:Function},formSchema:{type:Object,default:()=>({})},fields:{type:Object,default:()=>({})},handleOk:{type:Function}},setup(e){const o=(0,t.ref)(),l=(0,t.reactive)({visible:!0,confirmLoading:!1,dynamicValidateForm:e.formSchema}),n=()=>{l.confirmLoading=!0,o.value?.validate().then((async()=>{const t=await(e.handleOk&&e.handleOk(o.value?.modelRef,l)).finally((()=>l.confirmLoading=!1));("undefined"==typeof t||t)&&(l.visible=!1)})).catch((()=>{l.confirmLoading=!1}))};return{...(0,t.toRefs)(l),onOk:n,dynamicForm:o}}});const Fe=(0,k.Z)(Oe,[["render",Se]]);var je=Fe;let Le;const _e=e=>{Le=e},Ne={install:_e,show:e=>{let o;const l=document.createElement("div"),n=()=>{o=null,(0,t.render)(null,l),l.remove()};return o=(0,t.createVNode)(je,{...e,remove:n}),(0,t.nextTick)((()=>{Le&&(o.appContext=Le._instance?.appContext),(0,t.render)(o,l),document.body.appendChild(l)})),o}};var Pe=Ne}(),n}()}));